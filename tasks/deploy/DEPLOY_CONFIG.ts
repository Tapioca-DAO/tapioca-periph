import { EChainID } from '@tapioca-sdk/api/config';
import { BigNumber, fp } from 'tasks/deployBuilds/lbp/LBPNumbersUtils';

// Name of the contract deployments to be used in the deployment scripts and saved in the deployments file
export const DEPLOYMENT_NAMES = {
    // LBP
    LBP_AUTHORIZER: 'LBP_AUTHORIZER',
    LBP_VAULT: 'LBP_VAULT',
    LBP_BALANCER_QUERIES: 'LBP_BALANCER_QUERIES',
    TAP_USDC_LBP: 'TAP_USDC_LBP',
    // External
    YIELDBOX: 'YieldBox',
    YIELD_BOX_URI_BUILDER: 'YIELD_BOX_URI_BUILDER',
    // Magnetar
    MAGNETAR: 'MAGNETAR',
    MAGNETAR_ASSET_MODULE: 'MAGNETAR_ASSET_MODULE',
    MAGNETAR_ASSET_X_CHAIN_MODULE: 'MAGNETAR_ASSET_X_CHAIN_MODULE',
    MAGNETAR_COLLATERAL_MODULE: 'MAGNETAR_COLLATERAL_MODULE',
    MAGNETAR_MINT_MODULE: 'MAGNETAR_MINT_MODULE',
    MAGNETAR_MINT_X_CHAIN_MODULE: 'MAGNETAR_MINT_X_CHAIN_MODULE',
    MAGNETAR_OPTION_MODULE: 'MAGNETAR_OPTION_MODULE',
    MAGNETAR_YIELDBOX_MODULE: 'MAGNETAR_YIELDBOX_MODULE',
    MAGNETAR_BASE_MODULE_EXTERNAL: 'MAGNETAR_BASE_MODULE_EXTERNAL',
    MAGNETAR_HELPER: 'MAGNETAR_HELPER',
    // Oracles
    USDO_USDC_UNI_V3_ORACLE: 'USDO_USDC_UNI_V3_ORACLE',
    USDC_SEER_CL_ORACLE: 'USDC_SEER_CL_ORACLE',
    S_DAI_ORACLE: 'S_DAI_ORACLE',
    ETH_GLP_ORACLE: 'ETH_GLP_ORACLE',
    ETH_SEER_CL_ORACLE: 'ETH_SEER_CL_ORACLE',
    ETH_SEER_UNI_ORACLE: 'ETH_SEER_UNI_ORACLE',
    ETH_SEER_DUAL_ORACLE: 'ETH_SEER_DUAL_ORACLE',
    ZRO_ORACLE: 'ZRO_ORACLE',
    STG_USDC_V2_ORACLE: 'STG_USDC_V2_ORACLE',
    GMX_ORACLE: 'GMX_ORACLE',
    TAP_ORACLE: 'TAP_ORACLE',
    ADB_TAP_OPTION_ORACLE: 'ADB_TAP_OPTION_ORACLE',
    TOB_TAP_OPTION_ORACLE: 'TOB_TAP_OPTION_ORACLE',
    RETH_USD_SEER_CL_MULTI_ORACLE: 'RETH_USD_SEER_CL_MULTI_ORACLE',
    WSTETH_USD_SEER_CL_MULTI_ORACLE: 'WSTETH_USD_SEER_CL_MULTI_ORACLE',
    // Market Oracles
    MARKET_TETH_ORACLE: 'MARKET_TETH_ORACLE',
    MARKET_RETH_ORACLE: 'MARKET_RETH_ORACLE',
    MARKET_WSTETH_ORACLE: 'MARKET_WSTETH_ORACLE',
    MARKET_ZRO_ORACLE: 'MARKET_ZRO_ORACLE',
    MARKET_STG_USDC_V2_ORACLE: 'MARKET_STG_USDC_V2_ORACLE',
    MARKET_SDAI_ORACLE: 'MARKET_SDAI_ORACLE',
    // Misc
    PAUSER: 'PAUSER',
    TOE_HELPER: 'TOE_HELPER',
    PEARLMIT: 'PEARLMIT',
    CLUSTER: 'CLUSTER',
    ZERO_X_SWAPPER: 'ZERO_X_SWAPPER',
    ZERO_X_SWAPPER_MOCK: 'ZERO_X_SWAPPER_MOCK',
    TAP_WETH_UNI_V3_POOL: 'TAP_WETH_UNI_V3_POOL',
    ARRAKIS_TAP_WETH_VAULT: 'ARRAKIS_TAP_WETH_VAULT',
    USDO_USDC_UNI_V3_POOL: 'USDO_USDC_UNI_V3_POOL',
    ARRAKIS_USDO_USDC_VAULT: 'ARRAKIS_USDO_USDC_VAULT',
    TAP_TOKEN_YB_EMPTY_STRAT: 'TAP_TOKEN_YB_EMPTY_STRAT',
    WETH_YB_EMPTY_STRAT: 'WETH_YB_EMPTY_STRAT',
} as const;

/**
 * @notice !!! LBP CONFIG IS IN LBP DEPLOY SCRIPT !!!
 */
export type TLbp = {
    LBP_DURATION: number;
    START_BALANCES: [BigNumber, BigNumber];
    START_WEIGHTS: [BigNumber, BigNumber];
    END_WEIGHTS: [BigNumber, BigNumber];
    SWAP_FEE_PERCENTAGE: BigNumber;
    PAUSE_WINDOW_DURATION: number;
    BUFFER_PERIOD_DURATION: number;
};

export type TPostLbp = {
    [key in EChainID]?: {
        GMX_USD_CL_DATA_FEED_ADDRESS: string;
        GLP_MANAGER: string;
        WETH_USD_CL_DATA_FEED_ADDRESS: string;
        SDAI_USD_CUSTOM_CL_DATA_FEED_ADDRESS: string;
        USDC_USD_CL_DATA_FEED_ADDRESS: string;
        RETH_ETH_CL_DATA_FEED_ADDRESS: string;
        WSTETH_STETH_CL_DATA_FEED_ADDRESS: string;
        STETH_ETH_CL_DATA_FEED_ADDRESS: string;
        ZRO_USD_CL_DATA_FEED_ADDRESS: string;
        STG_USDC_V2_CL_DATA_FEED_ADDRESS: string;
    };
};

const POST_LBP: TPostLbp = {
    [EChainID.MAINNET]: {
        GMX_USD_CL_DATA_FEED_ADDRESS: '',
        GLP_MANAGER: '',
        WETH_USD_CL_DATA_FEED_ADDRESS: '',
        SDAI_USD_CUSTOM_CL_DATA_FEED_ADDRESS:
            '0xb9E6DBFa4De19CCed908BcbFe1d015190678AB5f',
        USDC_USD_CL_DATA_FEED_ADDRESS:
            '0x8fFfFfd4AfB6115b954Bd326cbe7B4BA576818f6',
        RETH_ETH_CL_DATA_FEED_ADDRESS: '',
        WSTETH_STETH_CL_DATA_FEED_ADDRESS: '',
        STETH_ETH_CL_DATA_FEED_ADDRESS: '',
        STG_USDC_V2_CL_DATA_FEED_ADDRESS: '',
        ZRO_USD_CL_DATA_FEED_ADDRESS: '',
    },
    [EChainID.ARBITRUM]: {
        GMX_USD_CL_DATA_FEED_ADDRESS:
            '0xdb98056fecfff59d032ab628337a4887110df3db',
        GLP_MANAGER: '0x3963FfC9dff443c2A94f21b129D429891E32ec18',
        WETH_USD_CL_DATA_FEED_ADDRESS:
            '0x639fe6ab55c921f74e7fac1ee960c0b6293ba612',
        SDAI_USD_CUSTOM_CL_DATA_FEED_ADDRESS: '',
        USDC_USD_CL_DATA_FEED_ADDRESS:
            '0x50834F3163758fcC1Df9973b6e91f0F0F0434aD3',
        RETH_ETH_CL_DATA_FEED_ADDRESS:
            '0xF3272CAfe65b190e76caAF483db13424a3e23dD2',
        WSTETH_STETH_CL_DATA_FEED_ADDRESS:
            '0xB1552C5e96B312d0Bf8b554186F846C40614a540',
        STETH_ETH_CL_DATA_FEED_ADDRESS:
            '0xded2c52b75B24732e9107377B7Ba93eC1fFa4BAf',
        STG_USDC_V2_CL_DATA_FEED_ADDRESS: '',
        ZRO_USD_CL_DATA_FEED_ADDRESS: '',
    },
    [EChainID.ARBITRUM_SEPOLIA]: {
        GMX_USD_CL_DATA_FEED_ADDRESS:
            '0xb09a4dE01be905e7C1f2d0d95eaDe2877110eDbF',
        GLP_MANAGER: '0x9Dd145b3C100498eE3BFF45E53cEB93cDe0075b4', // Locally deployed GLPManager Mock
        WETH_USD_CL_DATA_FEED_ADDRESS:
            '0x160fC08267b0A2699b2620C9033547518DbC996e', // Locally deployed WETH/USD Chainlink Mock
        SDAI_USD_CUSTOM_CL_DATA_FEED_ADDRESS: '',
        USDC_USD_CL_DATA_FEED_ADDRESS:
            '0x1190aE86f7e9531CB87504C9ce5bEd538a9c8aBa',
        RETH_ETH_CL_DATA_FEED_ADDRESS:
            '0x4B86Ba35eB0e12a9CF9f5888111845B35470c753',
        WSTETH_STETH_CL_DATA_FEED_ADDRESS:
            '0x361A3801ace0e2D1f5becdbb037495E4A3431F31',
        STETH_ETH_CL_DATA_FEED_ADDRESS:
            '0x62cb7087432546B446781Af289c61844c05CbfE9',
        STG_USDC_V2_CL_DATA_FEED_ADDRESS:
            '0x9165D79415A352ACD01e99E2ea6bC498846C61D0',
        ZRO_USD_CL_DATA_FEED_ADDRESS:
            '0x6F3538Cd8982245a18329585c7dF8949908EcE7a',
    },
    [EChainID.SEPOLIA]: {
        GMX_USD_CL_DATA_FEED_ADDRESS: '',
        GLP_MANAGER: '', // Locally deployed GLPManager Mock
        WETH_USD_CL_DATA_FEED_ADDRESS: '', // Locally deployed WETH/USD Chainlink Mock
        SDAI_USD_CUSTOM_CL_DATA_FEED_ADDRESS:
            '0xA30D6ad5f45EF99ea63A515F10bAA2C3B2f7720A',
        USDC_USD_CL_DATA_FEED_ADDRESS: '',
        RETH_ETH_CL_DATA_FEED_ADDRESS: '',
        WSTETH_STETH_CL_DATA_FEED_ADDRESS: '',
        STETH_ETH_CL_DATA_FEED_ADDRESS: '',
        STG_USDC_V2_CL_DATA_FEED_ADDRESS: '',
        ZRO_USD_CL_DATA_FEED_ADDRESS: '',
    },
    [EChainID.OPTIMISM_SEPOLIA]: {
        GMX_USD_CL_DATA_FEED_ADDRESS: '',
        GLP_MANAGER: '',
        WETH_USD_CL_DATA_FEED_ADDRESS: '',
        SDAI_USD_CUSTOM_CL_DATA_FEED_ADDRESS:
            '0x2dd69149d280B47659Df1648f420AD9a66c1A86f',
        USDC_USD_CL_DATA_FEED_ADDRESS: '',
        RETH_ETH_CL_DATA_FEED_ADDRESS: '',
        WSTETH_STETH_CL_DATA_FEED_ADDRESS: '',
        STETH_ETH_CL_DATA_FEED_ADDRESS: '',
        STG_USDC_V2_CL_DATA_FEED_ADDRESS: '',
        ZRO_USD_CL_DATA_FEED_ADDRESS: '',
    },
    [EChainID.FUJI_AVALANCHE]: {
        GMX_USD_CL_DATA_FEED_ADDRESS: '',
        GLP_MANAGER: '',
        WETH_USD_CL_DATA_FEED_ADDRESS: '',
        SDAI_USD_CUSTOM_CL_DATA_FEED_ADDRESS:
            '0x41607BA475cE7e8e3d563cE5ea7158Eee23B2ca9',
        USDC_USD_CL_DATA_FEED_ADDRESS:
            '0x2b0e5441a715eDeaC19677fe29B7322a481A8286',
        RETH_ETH_CL_DATA_FEED_ADDRESS: '',
        WSTETH_STETH_CL_DATA_FEED_ADDRESS: '',
        STETH_ETH_CL_DATA_FEED_ADDRESS: '',
        STG_USDC_V2_CL_DATA_FEED_ADDRESS: '',
        ZRO_USD_CL_DATA_FEED_ADDRESS: '',
    },
    [EChainID.BASE_SEPOLIA]: {
        GMX_USD_CL_DATA_FEED_ADDRESS: '',
        GLP_MANAGER: '',
        WETH_USD_CL_DATA_FEED_ADDRESS: '',
        SDAI_USD_CUSTOM_CL_DATA_FEED_ADDRESS:
            '0xFa692d399b1bdE26C0a9416624e3498A451c1370',
        USDC_USD_CL_DATA_FEED_ADDRESS:
            '0x6622e12b057c91CfA1baEe00AfDF57c07ae9d4d7',
        RETH_ETH_CL_DATA_FEED_ADDRESS: '',
        WSTETH_STETH_CL_DATA_FEED_ADDRESS: '',
        STETH_ETH_CL_DATA_FEED_ADDRESS: '',
        STG_USDC_V2_CL_DATA_FEED_ADDRESS: '',
        ZRO_USD_CL_DATA_FEED_ADDRESS: '',
    },
};

POST_LBP['31337' as EChainID] = POST_LBP[EChainID.ARBITRUM]; // Copy from Arbitrum

type TMisc = {
    [key in EChainID]?: {
        CL_SEQUENCER: string;
        WETH_USDC_UNIV3_LP: string;
        WETH: string;
        USDC: string;
        ZERO_X_PROXY: string;
        NONFUNGIBLE_POSITION_MANAGER: string;
        V3_SWAP_ROUTER: string;
        V3_FACTORY: string;
        ARRAKIS_FACTORY: string;
        ARRAKIS_RESOLVER: string;
    };
};

const MISC: TMisc = {
    // Mainnet
    [EChainID.ARBITRUM]: {
        CL_SEQUENCER: '0xFdB631F5EE196F0ed6FAa767959853A9F217697D', // Arbitrum mainnet ChainLink sequencer uptime feed
        WETH_USDC_UNIV3_LP: '0xC6962004f452bE9203591991D15f6b388e09E8D0', // WETH/USDC LP Arbitrum
        WETH: '0x82aF49447D8a07e3bd95BD0d56f35241523fBab1',
        USDC: '0xaf88d065e77c8cC2239327C5EDb3A432268e5831',
        ZERO_X_PROXY: '0xdef1c0ded9bec7f1a1670819833240f027b25eff',
        NONFUNGIBLE_POSITION_MANAGER:
            '0xc36442b4a4522e871399cd717abdd847ab11fe88',
        V3_FACTORY: '0x1F98431c8aD98523631AE4a59f267346ea31F984',
        V3_SWAP_ROUTER: '0x68b3465833fb72A70ecDF485E0e4C7bD8665Fc45',
        ARRAKIS_FACTORY: '0xECb8Ffcb2369EF188A082a662F496126f66c8288',
        ARRAKIS_RESOLVER: '0x535C5fDf31477f799366DF6E4899a12A801cC7b8',
    },
    [EChainID.MAINNET]: {
        CL_SEQUENCER: '0x', // Arbitrum mainnet ChainLink sequencer uptime feed
        WETH_USDC_UNIV3_LP: '0x', // WETH/USDC LP
        WETH: '0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2',
        USDC: '0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48',
        ZERO_X_PROXY: '0xdef1c0ded9bec7f1a1670819833240f027b25eff',
        NONFUNGIBLE_POSITION_MANAGER:
            '0xc36442b4a4522e871399cd717abdd847ab11fe88',
        V3_FACTORY: '0x1F98431c8aD98523631AE4a59f267346ea31F984',
        V3_SWAP_ROUTER: '0x68b3465833fb72A70ecDF485E0e4C7bD8665Fc45',
        ARRAKIS_FACTORY: '0xECb8Ffcb2369EF188A082a662F496126f66c8288',
        ARRAKIS_RESOLVER: '0x535C5fDf31477f799366DF6E4899a12A801cC7b8',
    },
    // Testnet
    [EChainID.ARBITRUM_SEPOLIA]: {
        CL_SEQUENCER: '0x0000000000000000000000000000000000000000',
        WETH_USDC_UNIV3_LP: '0x82DeFddE182B038A03fA48E838635Bc795099249', // Locally deployed WETH/USDC LP | USDCMock/WETH9 with - fee 500 - ratio 1/2000
        WETH: '0x2EAe4fbc552fE35C1D3Df2B546032409bb0E431E', // Locally deployed WETH9 Mock
        USDC: '0xF72c2794A9Ea95C5a8CD033999F319B15723E751', // Locally deployed USDC Mock
        ZERO_X_PROXY: '0x',
        NONFUNGIBLE_POSITION_MANAGER:
            '0xFd1a7CA61e49703da3618999B2EEdc0E79476759',
        V3_FACTORY: '0x76D8F1D83716bcd0f811449a76Fc2B3E3ef98454',
        V3_SWAP_ROUTER: '0x20C5707e71872463c3063247636fbcE434076597',
        ARRAKIS_FACTORY: '0x1c90088A93e9c7844aE0f0a6A7573891342BFe93',
        ARRAKIS_RESOLVER: '0xD0D11a8fFD49a4b0B90936dc97814DBbA6C8Dd78',
    },
    [EChainID.SEPOLIA]: {
        CL_SEQUENCER: '0x0000000000000000000000000000000000000000',
        WETH_USDC_UNIV3_LP: '',
        WETH: '0xD8a79b479b0c47675E3882A1DAA494b6775CE227',
        USDC: '',
        ZERO_X_PROXY: '0x',
        NONFUNGIBLE_POSITION_MANAGER:
            '0x0AF7f9B8Da22C12e78F8C4E23132B36a3a1CFfeb',
        V3_FACTORY: '0xD59F87D9c3d3aEC1eda7aFE1a117958C73364B6A',
        V3_SWAP_ROUTER: '0xd850cAFad5cCC56dAC25612cA0Fa847f1A9828CA',
        ARRAKIS_FACTORY: '0xECb8Ffcb2369EF188A082a662F496126f66c8288',
        ARRAKIS_RESOLVER: '0x535C5fDf31477f799366DF6E4899a12A801cC7b8',
    },
    [EChainID.OPTIMISM_SEPOLIA]: {
        CL_SEQUENCER: '0x0000000000000000000000000000000000000000',
        WETH_USDC_UNIV3_LP: '0x',
        WETH: '0x4fB538Ed1a085200bD08F66083B72c0bfEb29112', // Locally deployed WETH9 Mock
        USDC: '0xEa0C9CAef2A40Ea196473b3DE6e52Ca106BEeB2A', // Locally deployed USDC Mock
        ZERO_X_PROXY: '0x',
        NONFUNGIBLE_POSITION_MANAGER:
            '0x568DFf712af02F07A0b9dBEb6b019a9e11adC6Bd',
        V3_FACTORY: '0xd93F65e5Ee424891dBCDEAFE347a553C43d266b7',
        V3_SWAP_ROUTER: '', // Empty means not needed/intended for this chain
        ARRAKIS_FACTORY: '', // Empty means not needed/intended for this chain
        ARRAKIS_RESOLVER: '', // Empty means not needed/intended for this chain
    },
    [EChainID.FUJI_AVALANCHE]: {
        CL_SEQUENCER: '0x0000000000000000000000000000000000000000',
        WETH_USDC_UNIV3_LP: '0x',
        WETH: '0x4404EF158716dfad1c2BEffE9c7c8Fa261684544',
        USDC: '0x9CFCd2b64D9D187974207761C03fc9E2491d703c',
        ZERO_X_PROXY: '0x',
        NONFUNGIBLE_POSITION_MANAGER:
            '0x3E7F7A2530B77cb2268Cd0679208964D1A6064A9',
        V3_FACTORY: '0x3FE25Ce24b671346714b3feDec310c173153AAb5',
        V3_SWAP_ROUTER: '0x40C1BBF8CE9920FE1Be9c70b6b573eAb7145e67d',
        ARRAKIS_FACTORY: '0x54dfF8d101E41E44C2344CdF348eaDeFdE19D327',
        ARRAKIS_RESOLVER: '0xd8323a46d651D8653914FEcc2407412d876ff651',
    },
    [EChainID.BASE_SEPOLIA]: {
        CL_SEQUENCER: '0x0000000000000000000000000000000000000000',
        WETH_USDC_UNIV3_LP: '0x',
        WETH: '0x4aF9F18Eb6e595D7f876E71BBF6ac95EA99cF140',
        USDC: '',
        ZERO_X_PROXY: '0x',
        NONFUNGIBLE_POSITION_MANAGER:
            '0xf77d418B10642d497755a42F7EBD5578d7041bC9',
        V3_FACTORY: '0xDF474d2667bbD4488a7CbDEc1A27d0C667123AcF',
        V3_SWAP_ROUTER: '0x8147313b6469B53fF8c6ac089DcC9F54729aEaaf',
        ARRAKIS_FACTORY: '0x64f9B92D83A415DABd997f9FE348408D7bD8201e',
        ARRAKIS_RESOLVER: '0x38D0f2b009CaceC44403e57Ee1A4c9F533a5E74A',
    },
    [EChainID.BERACHAIN_TESTNET]: {
        CL_SEQUENCER: '0x0000000000000000000000000000000000000000',
        WETH_USDC_UNIV3_LP: '0x',
        WETH: '',
        USDC: '',
        ZERO_X_PROXY: '0x',
        NONFUNGIBLE_POSITION_MANAGER:
            '0xDF474d2667bbD4488a7CbDEc1A27d0C667123AcF',
        V3_FACTORY: '0x7d91FCA53809e393eCa64a09785330bc28DF0639',
        V3_SWAP_ROUTER: '0x8514f907386C4dd6bf214d7c3178c15C9954877f',
        ARRAKIS_FACTORY: '',
        ARRAKIS_RESOLVER: '',
    },
};
MISC['31337' as EChainID] = MISC[EChainID.ARBITRUM]; // Copy from Arbitrum

export const DEPLOY_CONFIG = {
    POST_LBP,
    MISC,
};
